在EXCEL表中按格式写入以下数据或者更多，保存为.csv格式
Name,SamAccountName,UserPrincipalName,GivenName,Surname,DisplayName,Path
Amy,Amy,Amy@cloudaddin.com,Amy,Amy,Amy,"ou=test,dc=cloudaddin,dc=com"
bob,bob,bob@cloudaddin.com,bob,bob,bob,"ou=test,dc=cloudaddin,dc=com"


在powershell中输入以下命令
Import-Csv c:\adduser.csv | foreach { New-ADUser -Name $_.name -SamAccountName $_.samaccountname -UserPrincipalName $_.userprincipalname -GivenName $_.givenname -Surname $_.surname -DisplayName $_.displayname -Path $_.path-AccountPassword (ConvertTo-SecureString "pwd" -AsPlainText -Force) -ChangePasswordAtLogon $true -Enabled $true}

####################################################################
$Ou=read-host "Whether there are organizational units [yes or no]"
if ( $Ou -eq 'no' ){
$Ou_Name=read-host "Please enter Organization unit"
New-ADOrganizationalUnit -Name $Ou_Name -Path "dc=cloudaddin,dc=com"  -ProtectedFromAccidentalDeletion:$false
}
$File_path=read-host "Please enter a file name and file path (Prompt: File name must end with .csv) [Example: C:\file.csv or ... ]"
$Name=read-host "Please enter a user login name"
$UserPrincipalName=Read-Host "Please enter UserPrincipalName (Prompt: example.com According to the actual domain name to define) [Example: user_login_name@example.com]"
$GivenName=read-host "Please enter First Name"
$Surname=Read-Host "Please enter Last Name"
$DisplayName=Read-Host "Please enter Display Name"
$Path=read-host "Please enter Path (Prompt: example.com According to the actual domain name to define) [Example: `"ou=Organization unit,dc=example,dc=com`"]"
$Passwd=read-host "Please enter passwd Password length must be more than 7 bits, the password complexity includes (letters, numbers, special symbols)"
"Name,UserPrincipalName,GivenName,Surname,DisplayName,Path" >> "$File_path"
"$Name,$UserPrincipalName,$GivenName,$Surname,$DisplayName,$Path" >> "$File_path" 
Import-Csv $File_path | foreach { New-ADUser -Name $_.name -UserPrincipalName $_.userprincipalname -GivenName $_.givenname -Surname $_.surname -DisplayName $_.displayname -Path $_.path -AccountPassword (ConvertTo-SecureString "$Passwd" -AsPlainText -Force) -CannotChangePassword $true -PasswordNeverExpires $true -Enabled $true } 
Remove-Item $File_path






###############################################################################
#枚举计算机信息脚本
$Local_domain=((ping localhost -a -n 1)[1] ).split()[1]
$Computer_name=$env:computername	
$IP=(ipconfig|findstr "IPv4") -split ":"
$memory=(Get-WmiObject -Class Win32_ComputerSystem).TotalPhysicalMemory /1gb
$ops = Get-WmiObject -Class Win32_OperatingSystem
$disk = Get-disk| Select-Object Size
clear-host


"登录用户 = $(whoami)" 
"主板厂商 = "+(Get-CimInstance Win32_BaseBoard).Manufacturer
"CPU信息 = "+(Get-CimInstance CIM_Processor).name
"硬盘型号 = "+(get-disk).FriendlyName
"磁盘大小 = $("{0} GB " -f [math]::truncate($disk.Size / 1GB))"
"操作系统 = "+(Get-CimInstance Win32_OperatingSystem).caption
"系统架构 = "+(Get-CimInstance Win32_OperatingSystem).OSArchitecture
"物理内存 = $([Math]::Round($memory,2)) GB"
"可用内存 = {0} GB" -f ([math]::round(($ops.FreePhysicalMemory / (1mb)), 2)) 
"网卡型号 = "+(Get-NetAdapter -Name * -Physical).InterfaceDescription
"MAC地址 = "+(Get-NetAdapter -Name * -Physical).MacAddress
"I P地址 =$($IP[1])"
"域名名称 = $Local_domain"
"计算机名 = $Computer_name"
"本机时间 = $(date)"

################慎用####################
#$MpsSvc=Get-Service MpsSvc            
#If($MpsSvc.Status -eq 'running')      
#{                                     
#$MpsSvc | Stop-Service               
#'防火墙状态 = 防火墙已关闭'              
#}
#elseIf($MpsSvc.Status -eq 'Stopped')
#{
# $MpsSvc | Start-Service
#'防火墙状态 = 防火墙已开启'
#}
########################################





